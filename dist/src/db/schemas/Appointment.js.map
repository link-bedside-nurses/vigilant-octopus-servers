{"version":3,"file":"Appointment.js","sourceRoot":"","sources":["../../../../src/db/schemas/Appointment.ts"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAAA,wDAAsD;AACtD,8EAA4E;AAC5E,kDAAgG;AAChG,qCAAmC;AAiBnC;IAAA;IAiCA,CAAC;IAVa,wCAAkB,GAA/B;;;;;wBACC,IAAI,CAAC,MAAM,GAAG,2CAAoB,CAAC,WAAW,CAAA;wBAC9C,qBAAM,IAAI,CAAC,IAAI,EAAE,EAAA;;wBAAjB,SAAiB,CAAA;;;;;KACjB;IAEY,uCAAiB,GAA9B,UAAiE,kBAA2B;;;;;wBAC3F,IAAI,CAAC,MAAM,GAAG,2CAAoB,CAAC,SAAS,CAAA;wBAC5C,IAAI,CAAC,kBAAkB,GAAG,kBAAkB,CAAA;wBAC5C,qBAAM,IAAI,CAAC,IAAI,EAAE,EAAA;;wBAAjB,SAAiB,CAAA;;;;;KACjB;IA9BD;QADC,IAAA,gBAAI,EAAE,EAAE,IAAI,EAAE,oBAAQ,CAAC,KAAK,CAAC,QAAQ,EAAE,QAAQ,EAAE,IAAI,EAAE,GAAG,EAAE,iBAAO,EAAE,CAAE;;gDACjD;IAGvB;QADC,IAAA,gBAAI,EAAE,EAAE,IAAI,EAAE,oBAAQ,CAAC,KAAK,CAAC,QAAQ,EAAE,QAAQ,EAAE,IAAI,EAAE,GAAG,EAAE,qBAAS,EAAE,KAAK,EAAE,IAAI,EAAE,CAAE;;kDAC5D;IAG3B;QADC,IAAA,gBAAI,EAAE,EAAE,QAAQ,EAAE,IAAI,EAAE,KAAK,EAAE,IAAI,EAAE,CAAE;;+CACzB;IAGf;QADC,IAAA,gBAAI,EAAE,EAAE,QAAQ,EAAE,IAAI,EAAE,OAAO,EAAE,IAAI,CAAC,GAAG,EAAE,EAAE,CAAE;kCACzC,IAAI;6CAAA;IAOX;QALC,IAAA,gBAAI,EAAE;YACN,IAAI,EAAE,2CAAoB;YAC1B,OAAO,EAAE,2CAAoB,CAAC,OAAO;YACrC,KAAK,EAAE,IAAI;SACX,CAAE;;+CACY;IAGf;QADC,IAAA,gBAAI,EAAE,EAAE,IAAI,EAAE,MAAM,EAAE,QAAQ,EAAE,KAAK,EAAE,OAAO,EAAE,EAAE,EAAE,CAAE;;2DAC5B;IArBf,WAAW;QAfvB,IAAA,wBAAY,EAAE;YACd,aAAa,EAAE;gBACd,EAAE,EAAE,KAAK;gBACT,QAAQ,EAAE,IAAI;gBACd,UAAU,EAAE,IAAI;gBAChB,QAAQ,EAAE,EAAE,QAAQ,EAAE,IAAI,EAAE;gBAC5B,MAAM,EAAE;oBACP,QAAQ,EAAE,IAAI;oBACd,SAAS,YAAE,IAAI,EAAE,GAAG;wBACnB,OAAO,GAAG,CAAC,GAAG,CAAA;oBACf,CAAC;iBACD;aACD;YACD,OAAO,EAAE,EAAE,UAAU,EAAE,oBAAQ,CAAC,KAAK,EAAE;SACvC,CAAE;OACU,WAAW,CAiCvB;IAAD,kBAAC;CAAA,AAjCD,IAiCC;AAjCY,kCAAW","sourcesContent":["import { Caregiver } from '../../db/schemas/Caregiver'\r\nimport { APPOINTMENT_STATUSES } from '../../interfaces/appointment-statuses'\r\nimport { DocumentType, Ref, Severity, modelOptions, mongoose, prop } from '@typegoose/typegoose'\r\nimport { Patient } from './Patient'\r\n\r\n@modelOptions( {\r\n\tschemaOptions: {\r\n\t\tid: false,\r\n\t\tvirtuals: true,\r\n\t\ttimestamps: true,\r\n\t\ttoObject: { virtuals: true },\r\n\t\ttoJSON: {\r\n\t\t\tvirtuals: true,\r\n\t\t\ttransform( _doc, ret ): void {\r\n\t\t\t\tdelete ret.__v\r\n\t\t\t},\r\n\t\t},\r\n\t},\r\n\toptions: { allowMixed: Severity.ALLOW },\r\n} )\r\nexport class Appointment {\r\n\t@prop( { type: mongoose.Types.ObjectId, required: true, ref: Patient } )\r\n\tpatient!: Ref<Patient>;\r\n\r\n\t@prop( { type: mongoose.Types.ObjectId, required: true, ref: Caregiver, index: true } )\r\n\tcaregiver!: Ref<Caregiver>;\r\n\r\n\t@prop( { required: true, index: true } )\r\n\treason!: string\r\n\r\n\t@prop( { required: true, default: Date.now() } )\r\n\tdate!: Date\r\n\r\n\t@prop( {\r\n\t\tenum: APPOINTMENT_STATUSES,\r\n\t\tdefault: APPOINTMENT_STATUSES.PENDING,\r\n\t\tindex: true,\r\n\t} )\r\n\tstatus!: string\r\n\r\n\t@prop( { type: String, required: false, default: '' } )\r\n\tcancellationReason?: string\r\n\r\n\tpublic async confirmAppointment( this: DocumentType<Appointment> ): Promise<void> {\r\n\t\tthis.status = APPOINTMENT_STATUSES.IN_PROGRESS\r\n\t\tawait this.save()\r\n\t}\r\n\r\n\tpublic async cancelAppointment( this: DocumentType<Appointment>, cancellationReason?: string ): Promise<void> {\r\n\t\tthis.status = APPOINTMENT_STATUSES.CANCELLED\r\n\t\tthis.cancellationReason = cancellationReason\r\n\t\tawait this.save()\r\n\t}\r\n}\r\n"]}