{"version":3,"file":"is-deactivated.js","sourceRoot":"","sources":["../../../src/middlewares/is-deactivated.ts"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAEA,2DAAwD;AACxD,4BAA0B;AAC1B,kCAAoC;AACpC,uDAA+C;AAE/C,SAA8B,aAAa,CAAE,OAAgB,EAAE,SAAmB,EAAE,IAAkB;;;;;;;yBAEhG,CAAA,CAAA,MAAA,OAAO,CAAC,OAAO,0CAAE,WAAW,MAAK,0BAAW,CAAC,KAAK,CAAA,EAAlD,wBAAkD;oBAC/C,qBAAM,OAAE,CAAC,MAAM,CAAC,QAAQ,CAAE,OAAO,CAAC,OAAO,CAAC,EAAE,CAAE,EAAA;;oBAArD,IAAI,GAAG,SAA8C,CAAA;;;yBAC1C,CAAA,CAAA,MAAA,OAAO,CAAC,OAAO,0CAAE,WAAW,MAAK,0BAAW,CAAC,KAAK,CAAA,EAAlD,wBAAkD;oBACtD,qBAAM,OAAE,CAAC,UAAU,CAAC,QAAQ,CAAE,OAAO,CAAC,OAAO,CAAC,EAAE,CAAE,EAAA;;oBAAzD,IAAI,GAAG,SAAkD,CAAA;;;yBAC9C,CAAA,CAAA,MAAA,OAAO,CAAC,OAAO,0CAAE,WAAW,MAAK,0BAAW,CAAC,OAAO,CAAA,EAApD,wBAAoD;oBACxD,qBAAM,OAAE,CAAC,QAAQ,CAAC,QAAQ,CAAE,OAAO,CAAC,OAAO,CAAC,EAAE,CAAE,EAAA;;oBAAvD,IAAI,GAAG,SAAgD,CAAA;;;oBAGxD,IAAK,IAAI,aAAJ,IAAI,uBAAJ,IAAI,CAAE,aAAa,EAAG,CAAC;wBAC3B,sBAAO,IAAI,CAAE,IAAI,iBAAS,CAAE,sEAAsE,EAAE,+BAAW,CAAC,SAAS,CAAE,CAAE,EAAA;oBAC9H,CAAC;oBAED,sBAAO,IAAI,EAAE,EAAA;;;;CACb;AAfD,gCAeC","sourcesContent":["import type { NextFunction, Request, Response } from 'express'\r\n\r\nimport { DESIGNATION } from '../interfaces/designations'\r\nimport { db } from '../db'\r\nimport { Exception } from '../utils'\r\nimport { StatusCodes } from 'http-status-codes'\r\n\r\nexport default async function isDeactivated( request: Request, _response: Response, next: NextFunction ) {\r\n\tlet user\r\n\tif ( request.account?.designation === DESIGNATION.ADMIN ) {\r\n\t\tuser = await db.admins.findById( request.account.id )\r\n\t} else if ( request.account?.designation === DESIGNATION.NURSE ) {\r\n\t\tuser = await db.caregivers.findById( request.account.id )\r\n\t} else if ( request.account?.designation === DESIGNATION.PATIENT ) {\r\n\t\tuser = await db.patients.findById( request.account.id )\r\n\t}\r\n\r\n\tif ( user?.isDeactivated ) {\r\n\t\treturn next( new Exception( 'Your account has been deactivated. Contact support for re-activation', StatusCodes.FORBIDDEN ) )\r\n\t}\r\n\r\n\treturn next()\r\n}\r\n"]}