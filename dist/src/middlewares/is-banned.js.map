{"version":3,"file":"is-banned.js","sourceRoot":"","sources":["../../../src/middlewares/is-banned.ts"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAEA,2DAAwD;AACxD,4BAA0B;AAC1B,kCAAoC;AACpC,uDAA+C;AAE/C,SAA8B,QAAQ,CAAE,OAAgB,EAAE,SAAmB,EAAE,IAAkB;;;;;;;yBAE3F,CAAA,CAAA,MAAA,OAAO,CAAC,OAAO,0CAAE,WAAW,MAAK,0BAAW,CAAC,KAAK,CAAA,EAAlD,wBAAkD;oBAC/C,qBAAM,OAAE,CAAC,MAAM,CAAC,QAAQ,CAAE,OAAO,CAAC,OAAO,CAAC,EAAE,CAAE,EAAA;;oBAArD,IAAI,GAAG,SAA8C,CAAA;;;yBAC1C,CAAA,CAAA,MAAA,OAAO,CAAC,OAAO,0CAAE,WAAW,MAAK,0BAAW,CAAC,KAAK,CAAA,EAAlD,wBAAkD;oBACtD,qBAAM,OAAE,CAAC,UAAU,CAAC,QAAQ,CAAE,OAAO,CAAC,OAAO,CAAC,EAAE,CAAE,EAAA;;oBAAzD,IAAI,GAAG,SAAkD,CAAA;;;yBAC9C,CAAA,CAAA,MAAA,OAAO,CAAC,OAAO,0CAAE,WAAW,MAAK,0BAAW,CAAC,OAAO,CAAA,EAApD,wBAAoD;oBACxD,qBAAM,OAAE,CAAC,QAAQ,CAAC,QAAQ,CAAE,OAAO,CAAC,OAAO,CAAC,EAAE,CAAE,EAAA;;oBAAvD,IAAI,GAAG,SAAgD,CAAA;;;oBAGxD,IAAK,IAAI,aAAJ,IAAI,uBAAJ,IAAI,CAAE,QAAQ,EAAG,CAAC;wBACtB,sBAAO,IAAI,CAAE,IAAI,iBAAS,CAAE,gDAAgD,EAAE,+BAAW,CAAC,SAAS,CAAE,CAAE,EAAA;oBACxG,CAAC;oBAED,sBAAO,IAAI,EAAE,EAAA;;;;CACb;AAfD,2BAeC","sourcesContent":["import type { NextFunction, Request, Response } from 'express'\r\n\r\nimport { DESIGNATION } from '../interfaces/designations'\r\nimport { db } from '../db'\r\nimport { Exception } from '../utils'\r\nimport { StatusCodes } from 'http-status-codes'\r\n\r\nexport default async function isBanned( request: Request, _response: Response, next: NextFunction ) {\r\n\tlet user\r\n\tif ( request.account?.designation === DESIGNATION.ADMIN ) {\r\n\t\tuser = await db.admins.findById( request.account.id )\r\n\t} else if ( request.account?.designation === DESIGNATION.NURSE ) {\r\n\t\tuser = await db.caregivers.findById( request.account.id )\r\n\t} else if ( request.account?.designation === DESIGNATION.PATIENT ) {\r\n\t\tuser = await db.patients.findById( request.account.id )\r\n\t}\r\n\r\n\tif ( user?.isBanned ) {\r\n\t\treturn next( new Exception( 'You have been banned from accessing the system', StatusCodes.FORBIDDEN ) )\r\n\t}\r\n\r\n\treturn next()\r\n}\r\n"]}